<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Wordle_Infinite</title>
  <style>
    :root{
      --bg:#0f1220;
      --tile:#1b2036;
      --tile-border:#2b3155;
      --text:#e8ebff;
      --muted:#b8c1ff;
      --correct:#3aa394;    
      --present:#d3ad69;    
      --absent:#404560;     
      --accent:#7aa2ff;
      --danger:#ff6b6b;
      --kbd:#20264a;
      --kbd-border:#2b3155;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:radial-gradient(1000px 500px at 50% -100px, #1a1f3d 0%, #0f1220 55%, #0b0d18 100%) fixed;
      color:var(--text); display:flex; align-items:center; justify-content:center;
    }
    .app{ width:min(92vw, 480px); }
    header{ display:flex; align-items:center; justify-content:space-between; margin:8px 0 14px; }
    h1{ margin:0; font-size: clamp(18px, 4.5vw, 24px); letter-spacing:1px; font-weight:800; }
    .btn{ background:transparent; color:var(--muted); border:1px solid var(--kbd-border); padding:8px 10px; border-radius:12px; cursor:pointer; transition:transform .08s ease, background .2s ease, border-color .2s ease; font-weight:600 }
    .btn:hover{ transform:translateY(-1px); border-color:var(--accent); color:var(--text)}

    .board{ display:grid; grid-template-rows: repeat(6, 1fr); gap:8px; }
    .row{ display:grid; grid-template-columns:repeat(5, 1fr); gap:8px; }

    .tile{
      width:100%; aspect-ratio:1/1; border:2px solid var(--tile-border); background:var(--tile);
      display:grid; place-items:center; font-size: clamp(18px, 6vw, 28px); font-weight:800; text-transform:uppercase; border-radius:12px;
      user-select:none; position:relative; transform-style:preserve-3d;
    }
    .tile.filled{ border-color:var(--accent); }

    .tile.revealed.correct{ background:var(--correct); border-color:var(--correct); color:#081c17; }
    .tile.revealed.present{ background:var(--present); border-color:var(--present); color:#231b08; }
    .tile.revealed.absent{ background:var(--absent); border-color:var(--absent); color:#c5cbff; }

    @keyframes pop { 0%{transform:scale(1)} 50%{transform:scale(1.08)} 100%{transform:scale(1)} }
    .tile.pop{ animation:pop .08s ease-out; }

    @keyframes shake{ 10%, 90%{transform:translateX(-2px)} 20%,80%{transform:translateX(3px)} 30%,50%,70%{transform:translateX(-6px)} 40%,60%{transform:translateX(6px)} }
    .row.shake{ animation:shake .5s ease both; }

    @keyframes flip { 0%{ transform: rotateX(0); } 49%{ border-color:var(--tile); } 50%{ transform: rotateX(90deg); background:var(--tile); } 100%{ transform: rotateX(0); } }
    .tile.flip{ animation:flip .6s ease both; }

    .keyboard{ margin-top:16px; user-select:none; }
    .kb-row{ display:flex; gap:6px; justify-content:center; margin:5px 0; }
    .key{ background:var(--kbd); border:1px solid var(--kbd-border); border-bottom-width:3px; border-radius:10px; padding:14px 10px; min-width:30px; text-transform:uppercase; font-weight:700; letter-spacing:.5px; cursor:pointer; transition:transform .05s ease, background .2s ease, border-color .2s ease; }
    .key:active{ transform:translateY(1px); border-bottom-width:2px; }
    .key.wide{ flex:1; max-width:110px; }
    .key.correct{ background:var(--correct); color:#081c17; border-color:#2a7a6f; }
    .key.present{ background:var(--present); color:#231b08; border-color:#a7884e; }
    .key.absent{ background:var(--absent); color:#c5cbff; border-color:#303452; }

    .bar{ display:flex; gap:8px; justify-content:space-between; align-items:center; margin-bottom:10px; }
    .status{ font-size:14px; color:var(--muted); min-height:18px; }

    dialog{ border:none; border-radius:16px; padding:0; background:#141833; color:var(--text); box-shadow:0 20px 60px rgba(0,0,0,.5); width:min(92vw, 460px); }
    .modal{ padding:18px; }
    .modal h2{ margin:0 0 8px; font-size:20px; }
    .row.word{ grid-template-columns:repeat(5, 40px); justify-content:center; }

    .foot{ display:flex; gap:8px; justify-content:space-between; align-items:center; margin-top:10px; }
    .link{ color:var(--accent); text-decoration:none; }
    .sr{ position:absolute; left:-9999px; }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="Wordlet game">
    <header>
      <h1>Wordle_Infinite</h1>
      <div>
        <button id="btn-new" class="btn" title="Start new game">New Game</button>
        <button id="btn-help" class="btn" title="How to play">Help</button>
      </div>
    </header>

    <div class="bar">
      <div id="status" class="status" aria-live="polite"></div>
      <div id="date" class="status"></div>
    </div>

    <div id="board" class="board" aria-label="Guess grid"></div>
    <div class="keyboard" aria-label="On-screen keyboard">
      <div class="kb-row" id="kb-row-1"></div>
      <div class="kb-row" id="kb-row-2"></div>
      <div class="kb-row" id="kb-row-3"></div>
    </div>
  </div>

  <dialog id="modal">
    <div class="modal">
      <h2>How to play</h2>
      <p>Guess the 5-letter word in 6 tries. Use your keyboard or tap the on-screen keys.</p>
      <p>Tile colors show how close your guess was:</p>
      <div class="row word" aria-hidden="true" style="margin:10px 0 6px">
        <div class="tile revealed correct">W</div>
        <div class="tile revealed present">O</div>
        <div class="tile revealed absent">R</div>
        <div class="tile">D</div>
        <div class="tile">S</div>
      </div>
      <ul>
        <li><strong>Green</strong>: letter is in the word and in the right spot.</li>
        <li><strong>Yellow</strong>: letter is in the word but the wrong spot.</li>
        <li><strong>Gray</strong>: letter is not in the word.</li>
      </ul>
      <div class="foot">
        <span style="color:var(--muted)">Tip: Press <kbd>Enter</kbd> to submit, <kbd>Backspace</kbd> to delete.</span>
        <button id="btn-close" class="btn">Got it</button>
      </div>
    </div>
  </dialog>

  <script>

    const $ = (q, el=document) => el.querySelector(q);
    const $$ = (q, el=document) => Array.from(el.querySelectorAll(q));

    const ALPH = "qwertyuiopasdfghjklzxcvbnm";
    const KEY_ROWS = [
      "qwertyuiop".split(""),
      "asdfghjkl".split(""),
      ["Enter", ..."zxcvbnm".split(""), "⌫"],
    ];

   
    const ANSWERS = [
      "about","other","which","their","there","first","would","these","click","price",
      "world","music","after","video","where","books","links","years","order","items",
      "could","sound","great","hotel","store","terms","right","local","those","using",
      "phone","forum","based","black","check","index","being","women","today","south",
      "photo","power","while","three","total","place","think","north","posts","media",
      "water","since","guide","board","white","small","times","sites","level","hours",
      "image","title","shall","class","still","money","every","visit","tools","reply",
      "value","press","learn","print","count","house","maybe","young","field","paper",
      "girls","night","texas","poker","issue","range","court","audio","light","write",
      "offer","given","files","event","china","needs","might","month","major","areas",
      "space","cards","child","enter","share","added","radio","until","color","track",  
      "abyss","acorn","adobe","affix","aglow","askew","azure","banjo","befog","briar",
      "blitz","boozy","bugle","bylaw","cacao","caddy","caper","cavil","chasm","chord",
      "clamp","cloak","clove","coyly","crimp","crypt","cynic","dandy","deign","ditto",
      "dowdy","eerie","elope","ember","ennui","epoxy","ethos","evoke","fable","femur",
      "fetus","fjord","flint","fugue","gaffe","gavel","glint","glyph","gnash","guava",
      "gypsy","hazel","heist","hymen","icily","ivory","jiffy","jolly","joule","juror",
      "kayak","knack","koala","llama","lurid","lynch","macaw","maxim","mezzo","mimic",
      "mirth","modal","moult","nymph","obese","onset","oxide","pagan","pithy","proxy",
      "quark","quart","queue","quill","quirk","rabid","raven","redux","reign","rogue",
      "satyr","savvy","scoff","sedge","skulk","slyly","smirk","spurn","squib","swath"
    ];

    // Accept any 5-letter alphabetic guess to keep the bundle small.
    const isFiveLetters = (s) => /^[a-z]{5}$/.test(s);

    function rng(seed){
      let t = seed + 0x6D2B79F5;
      return function(){
        t |= 0; t = t + 0x6D2B79F5 | 0; let r = Math.imul(t ^ t >>> 15, 1 | t);
        r ^= r + Math.imul(r ^ r >>> 7, 61 | r);
        return ((r ^ r >>> 14) >>> 0) / 4294967296;
      }
    }

    function pickDailyWord(){
      const d0 = new Date(Date.UTC(2022,0,1));
      const today = new Date();
      const days = Math.floor((Date.UTC(today.getFullYear(), today.getMonth(), today.getDate()) - d0.getTime())/86400000);
      const r = rng(days);
      return ANSWERS[Math.floor(r()*ANSWERS.length)];
    }


    const state = {
      answer: pickDailyWord(),
      row: 0,
      col: 0,
      grid: Array.from({length:6}, ()=>Array(5).fill("")),
      marks: Array.from({length:6}, ()=>Array(5).fill(null)), 
      finished: false,
    };

    const LS_KEY = "wordlet-save-v2";

    function save(){
      try{ localStorage.setItem(LS_KEY, JSON.stringify({
        answer: state.answer, row: state.row, col: state.col, grid: state.grid, marks: state.marks, finished: state.finished
      })); }catch{}
    }
    function load(){
      try{
        const raw = localStorage.getItem(LS_KEY);
        if(!raw) return;
        const s = JSON.parse(raw);
        if(s && typeof s.answer === 'string' && s.grid?.length===6){
          Object.assign(state, s);
        }
      }catch{}
    }


    const boardEl = $("#board");
    const statusEl = $("#status");
    const dateEl = $("#date");

    function buildBoard(){
      boardEl.innerHTML = "";
      for(let r=0;r<6;r++){
        const row = document.createElement('div'); row.className='row'; row.dataset.r=r;
        for(let c=0;c<5;c++){
          const t = document.createElement('div'); t.className='tile'; t.dataset.r=r; t.dataset.c=c; t.setAttribute('aria-label',`Row ${r+1} Col ${c+1}`);
          row.appendChild(t);
        }
        boardEl.appendChild(row);
      }
    }

    function buildKeyboard(){
      $("#kb-row-1").innerHTML = KEY_ROWS[0].map(k=>keyHTML(k)).join("");
      $("#kb-row-2").innerHTML = KEY_ROWS[1].map(k=>keyHTML(k)).join("");
      $("#kb-row-3").innerHTML = KEY_ROWS[2].map(k=>keyHTML(k)).join("");
    }
    function keyHTML(k){
      const label = (k==="⌫")?"Backspace":k;
      return `<button class="key" data-key="${label}">${k}</button>`;
    }


    function render(){
      // Tiles
      for(let r=0;r<6;r++){
        for(let c=0;c<5;c++){
          const t = document.querySelector(`.tile[data-r="${r}"][data-c="${c}"]`);
          const ch = state.grid[r][c] || "";
          t.textContent = ch;
          t.classList.toggle('filled', !!ch);
          const mark = state.marks[r][c];
          t.classList.remove('revealed','correct','present','absent');
          if(mark){ t.classList.add('revealed', mark); }
        }
      }
      const best = {}; 
      for(let r=0;r<6;r++){
        for(let c=0;c<5;c++){
          const m = state.marks[r][c]; const ch = state.grid[r][c];
          if(!m || !ch) continue;
          const score = m==='correct'?3 : m==='present'?2 : 1;
          if((best[ch]||0) < score) best[ch]=score;
        }
      }
      $$('.key').forEach(k=>{
        const v = k.dataset.key;
        if(v.length===1){
          k.classList.remove('correct','present','absent');
          if(best[v]===3) k.classList.add('correct');
          else if(best[v]===2) k.classList.add('present');
          else if(best[v]===1) k.classList.add('absent');
        }
      });

      if(state.finished){
        if(won()) statusEl.textContent = `Nice! The word was "${state.answer.toUpperCase()}".`;
        else statusEl.textContent = `Out of tries — the word was "${state.answer.toUpperCase()}".`;
      } else {
        statusEl.textContent = `Row ${state.row+1} of 6`;
      }
    }


    function submit(){
      if(state.finished) return;
      if(state.col<5) return shakeRow(state.row, "Not enough letters");
      const guess = state.grid[state.row].join("");
      if(!isFiveLetters(guess)) return shakeRow(state.row, "Use letters only");

      const marks = scoreGuess(guess, state.answer);
      state.marks[state.row] = marks;

      const tiles = $$('.tile', document.querySelector(`.row[data-r="${state.row}"]`));
      tiles.forEach((t,i)=>{ setTimeout(()=>{ t.classList.add('flip'); setTimeout(()=>{ t.classList.remove('flip'); t.classList.add('revealed', marks[i]); if(i===4){
        if(guess===state.answer){ state.finished=true; }
        else if(state.row===5){ state.finished=true; }
        else { state.row++; state.col=0; }
        save(); render();
      } }, 320); }, i*180); });
    }

    function scoreGuess(guess, answer){
      const a = answer.split("");
      const g = guess.split("");
      const res = Array(5).fill('absent');
      const freq = {};
      for(const ch of a){ freq[ch] = (freq[ch]||0)+1; }
      for(let i=0;i<5;i++){
        if(g[i]===a[i]){ res[i]='correct'; freq[g[i]]--; }
      }
      for(let i=0;i<5;i++){
        if(res[i]==='correct') continue;
        const ch = g[i];
        if(freq[ch]>0){ res[i]='present'; freq[ch]--; }
      }
      return res;
    }

    function won(){
      return state.marks.some((row,i)=> row.every(m=>m==='correct'));
    }

    function type(ch){
      if(state.finished) return;
      if(ch==="Enter") return submit();
      if(ch==="Backspace") return erase();
      if(!/^[a-z]$/i.test(ch)) return;
      if(state.col>=5) return;
      state.grid[state.row][state.col] = ch.toLowerCase();
      state.col++;
      bump(state.row, state.col-1);
      save(); render();
    }
    function erase(){
      if(state.finished) return;
      if(state.col===0) return;
      state.col--; state.grid[state.row][state.col] = "";
      save(); render();
    }

    function bump(r,c){
      const t = document.querySelector(`.tile[data-r="${r}"][data-c="${c}"]`);
      t.classList.remove('pop');
      void t.offsetWidth; 
      t.classList.add('pop');
    }

    function shakeRow(r, msg){
      const row = document.querySelector(`.row[data-r="${r}"]`);
      row.classList.remove('shake'); void row.offsetWidth; row.classList.add('shake');
      statusEl.textContent = msg; setTimeout(()=>{ statusEl.textContent = `Row ${state.row+1} of 6`; }, 900);
    }

    document.addEventListener('keydown', (e)=>{
      if($("#modal").open) return; 
      type(e.key);
    });

    document.body.addEventListener('click', (e)=>{
      const key = e.target.closest('.key');
      if(key){ type(key.dataset.key); }
    });

    $("#btn-new").addEventListener('click', ()=>{
      state.answer = ANSWERS[Math.floor(Math.random()*ANSWERS.length)];
      state.row = 0; state.col = 0; state.grid = Array.from({length:6}, ()=>Array(5).fill(""));
      state.marks = Array.from({length:6}, ()=>Array(5).fill(null));
      state.finished=false; save(); render();
    });

    const modal = $("#modal");
    $("#btn-help").addEventListener('click', ()=> modal.showModal());
    $("#btn-close").addEventListener('click', ()=> modal.close());
    modal.addEventListener('click', (e)=>{ 
      const rect = $('.modal', modal).getBoundingClientRect();
      if(e.clientX < rect.left || e.clientX > rect.right || e.clientY < rect.top || e.clientY > rect.bottom) modal.close();
    });


    buildBoard();
    buildKeyboard();
    load();
    render();
    const d = new Date();
    dateEl.textContent = d.toLocaleDateString(undefined, { month:'short', day:'numeric' });

    window.Wordlet = {
      setAnswer(word){ if(isFiveLetters(word)) { state.answer = word.toLowerCase(); save(); } },
      newGame(){ $("#btn-new").click(); },
      getState(){ return JSON.parse(JSON.stringify(state)); }
    };
  </script>
</body>
</html>
